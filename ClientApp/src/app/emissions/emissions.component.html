<div class="container">
  <p-table
    selectionMode="single" 
    (onRowSelect)="onRowSelect($event)"
    [lazy] = true
    (onLazyLoad) = "loadCustomers($event)"
    [value]="customers"
    [responsive] = false
    [paginator]="true"
    [rows]="5"
    [totalRecords]="totalRecords"
    [loading]="loading"
    styleClass="p-datatable-gridlines"
  >
    <ng-template pTemplate="caption">
      <button class="ui-button-success" (click)="exportExcel()"><i class="bi bi-file-earmark-spreadsheet"></i></button>
    </ng-template>
    
    <ng-template pTemplate="header">
      <tr>
        <th>
          <div class="d-flex justify-content-between align-items-center">
            <div pSortableColumn="name">
              Utwor <p-sortIcon field="name"></p-sortIcon>
            </div>
            <div>
              <p-columnFilter
                type="text"
                field="name"
                [matchModeOptions]="textModeOptions"
                display="menu"
                [showMatchModes]="true" [showOperator]="false" [showAddButton]="false">
              </p-columnFilter>
            </div>
          </div>
        </th>

        <th>
          <div class="d-flex justify-content-between align-items-center">
          <div pSortableColumn="country.name">
            Kanal <p-sortIcon field="country.name"></p-sortIcon>
          </div>
          <div>
            <p-columnFilter
              type="text"
              field="country.name"
              [matchModeOptions]="textModeOptions"
              display="menu"
              [showMatchModes]="true" [showOperator]="false" [showAddButton]="false"
            ></p-columnFilter>
          </div>
        </div>
        </th>

        <th>
          <div class="d-flex justify-content-between align-items-center">
          <div pSortableColumn="date">
            Data <p-sortIcon field="date"></p-sortIcon>
          </div>
          <div>
            <p-columnFilter
              type="date"
              field="date"
              [matchModeOptions]="dateModeOptions"
              display="menu"
              [showMatchModes]="true" [showOperator]="false" [showAddButton]="false" [showApplyButton]="false">
              <ng-template pTemplate="filter" let-date let-filter="filterCallback">
                <p-calendar (onSelect)="filter($event)" [ngModel]="date" [showTime]=true dateFormat="dd.mm.yy"></p-calendar>
              </ng-template>
            </p-columnFilter>
          </div>
        </div>
        </th>

        <th>
          <div class="d-flex justify-content-between align-items-center">
          <div pSortableColumn="company">
            Czas trwania <p-sortIcon field="company"></p-sortIcon>
          </div>
          <div>
            <p-columnFilter
              type="numeric"
              field="company"
              [matchModeOptions]="durationModeOptions"
              display="menu"
              [showMatchModes]="true" [showOperator]="false" [showAddButton]="false" [showApplyButton]="false"
            >
            <ng-template pTemplate="filter" let-filter="filterCallback">
              <p-calendar (onClose)="filter($event.element.innerText)" [(ngModel)]="selectedTime" [timeOnly]="true" inputId="timeonly"></p-calendar>
            </ng-template>
          </p-columnFilter>
          </div>
        </div>
        </th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-customer>
      <tr [pSelectableRow]="customer">
        <td class="p-fluid">{{ customer.name }}</td>
        <td class="p-fluid">{{ customer.country.name }}</td>
        <td class="p-fluid">{{ customer.date | date: "dd.MM.yyyy HH:mm:ss" }}</td>
        <td class="p-fluid">{{ customer.company }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>
